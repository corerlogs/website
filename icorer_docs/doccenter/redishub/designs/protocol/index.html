<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Protocol layer design # A good access method of the application can accelerate the growth of the application ecology, and a good protocol design can reduce the transformation cost of the stock application, so the protocol layer is an important component of the IceFireDB software stack. The communication protocol of IceFireDB-NoSQL fully integrates the Redis RESP protocol, which mainly includes the following two parts of the protocol:
Data control protocol: Complete support for RESP clients, supporting functional requirements for database data access."><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:type" content="website"><meta property="og:image" content="https://res.cloudinary.com/malloc/image/upload/v1666510486/icefiredb/logo_z8koem.png"><meta property="og:title" content="Protocol layer"><meta property="og:description" content="Protocol layer design # A good access method of the application can accelerate the growth of the application ecology, and a good protocol design can reduce the transformation cost of the stock application, so the protocol layer is an important component of the IceFireDB software stack. The communication protocol of IceFireDB-NoSQL fully integrates the Redis RESP protocol, which mainly includes the following two parts of the protocol:
Data control protocol: Complete support for RESP clients, supporting functional requirements for database data access."><meta property="og:type" content="article"><meta property="og:url" content="https://icorer.com/icorer_docs/doccenter/redishub/designs/protocol/"><meta property="article:section" content="DocCenter"><title>Protocol layer | 工匠之芯-文档中心</title><link rel=manifest href=/icorer_docs/manifest.json><link rel=icon href=/icorer_docs/favicon.ico type=image/x-icon><link rel=stylesheet href=/icorer_docs/book.min.46181bc93375ba932026e753b37c40e6ff8bb16a9ef770c78bcc663e4577b1ba.css integrity="sha256-RhgbyTN1upMgJudTs3xA5v+LsWqe93DHi8xmPkV3sbo=" crossorigin=anonymous><script defer src=/icorer_docs/flexsearch.min.js></script>
<script defer src=/icorer_docs/en.search.min.21b0be0671f6a316f6d5a22821d90e9d922988ce198f326660a47ba81bf3a34e.js integrity="sha256-IbC+BnH2oxb21aIoIdkOnZIpiM4ZjzJmYKR7qBvzo04=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/icorer_docs/><span>工匠之芯-文档中心</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://icorer.com/ target=_blank rel=noopener>工匠之芯</a></li><li><a href=https://github.com/gitsrc target=_blank rel=noopener>Open Source</a></li></ul><ul><li class=book-section-flat><a href=https://icorer.com/icorer_docs/doccenter/>项目总览</a><ul><li><input type=checkbox id=section-aed24396fef473497b12e93db0aa8548 class=toggle checked>
<label for=section-aed24396fef473497b12e93db0aa8548 class="flex justify-between"><a href=https://icorer.com/icorer_docs/doccenter/redishub/>RedisHub</a></label><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/quick_start/>Quick Start</a><ul></ul></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/>Designs</a><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/network/>Network layer</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/storage/>Storage layer</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/protocol/ class=active>Protocol layer</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/codec/>Codec layer</a></li></ul></li><li><span>Develop</span><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/develop/icefiredb-crdt-kv/>icefiredb-crdt-kv</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/develop/icefiredb-ipfs-log/>icefiredb-ipfs-log</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/develop/icefiredb_proxy/>icefiredb-proxy</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/develop/redhub/>redhub-frame</a></li></ul></li><li><span>Project Comparison</span><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/project-comparison/orbitdb/>OrbitDB</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/project-comparison/threaddb/>ThreadDB</a></li></ul></li></ul></li><li><input type=checkbox id=section-1453ce2c5ecb8c18c2860dade55163de class=toggle>
<label for=section-1453ce2c5ecb8c18c2860dade55163de class="flex justify-between"><a role=button>PulseFlow</a></label><ul><li><input type=checkbox id=section-b349698f86361cb77fa3daf6029bb134 class=toggle>
<label for=section-b349698f86361cb77fa3daf6029bb134 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://icorer.com/icorer_docs/doccenter/pulseflow/architecture/overview/>OverView</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/pulseflow/architecture/network/>NetWork</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/pulseflow/architecture/storage/>Storage</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/pulseflow/architecture/protocol/>Protocol</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/pulseflow/architecture/codec/>Codec</a></li></ul></li></ul></li><li><input type=checkbox id=section-14e1ec26ce57d625211daa6855b123ba class=toggle>
<label for=section-14e1ec26ce57d625211daa6855b123ba class="flex justify-between"><a role=button>RedisTun</a></label><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/quick_start/>Quick Start</a><ul></ul></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/designs/>Designs</a><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/designs/network/>Network layer</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/designs/storage/>Storage layer</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/designs/protocol/>Protocol layer</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/designs/codec/>Codec layer</a></li></ul></li><li><span>Develop</span><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/develop/icefiredb-crdt-kv/>icefiredb-crdt-kv</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/develop/icefiredb-ipfs-log/>icefiredb-ipfs-log</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/develop/icefiredb_proxy/>icefiredb-proxy</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/develop/redhub/>redhub-frame</a></li></ul></li><li><span>Project Comparison</span><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/project-comparison/orbitdb/>OrbitDB</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/project-comparison/threaddb/>ThreadDB</a></li></ul></li></ul></li><li><input type=checkbox id=section-404d707d87f9ef4c7b157ec13db25c80 class=toggle>
<label for=section-404d707d87f9ef4c7b157ec13db25c80 class="flex justify-between"><a role=button>LogDarts</a></label><ul><li><input type=checkbox id=section-658ed1b71722eedc365fde2c5579594f class=toggle>
<label for=section-658ed1b71722eedc365fde2c5579594f class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://icorer.com/icorer_docs/doccenter/logdarts/architecture/overview/>OverView</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/logdarts/architecture/network/>NetWork</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/logdarts/architecture/storage/>Storage</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/logdarts/architecture/protocol/>Protocol</a></li></ul></li></ul></li><li><input type=checkbox id=section-a22dab337e8b55a3f7712060bcd10bb9 class=toggle>
<label for=section-a22dab337e8b55a3f7712060bcd10bb9 class="flex justify-between"><a role=button>AK-2019</a></label><ul><li><input type=checkbox id=section-549f710dc768b95bd2287ab37bb3db61 class=toggle>
<label for=section-549f710dc768b95bd2287ab37bb3db61 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://icorer.com/icorer_docs/doccenter/ak-2019/architecture/overview/>OverView</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/ak-2019/architecture/network/>NetWork</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/ak-2019/architecture/storage/>Storage</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/ak-2019/architecture/protocol/>Protocol</a></li></ul></li></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/icorer_docs/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Protocol layer</strong>
<label for=toc-control><img src=/icorer_docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#protocol-advantages>Protocol advantages</a></li><li><a href=#data-control-protocol>Data control protocol</a></li><li><a href=#cluster-control-protocol>Cluster control protocol</a></li></ul></nav></aside></header><article class=markdown><h1 id=protocol-layer-design>Protocol layer design
<a class=anchor href=#protocol-layer-design>#</a></h1><p>A good access method of the application can accelerate the growth of the application ecology, and a good protocol design can reduce the transformation cost of the stock application, so the protocol layer is an important component of the IceFireDB software stack. The communication protocol of IceFireDB-NoSQL fully integrates the Redis RESP protocol, which mainly includes the following two parts of the protocol:</p><ol><li><p><strong>Data control protocol</strong>: Complete support for RESP clients, supporting functional requirements for database data access.</p></li><li><p><strong>Cluster control protocol</strong>: Satisfy the client&rsquo;s command protocol for controlling the nodes of the IceFireDB cluster and viewing the status and availability status of the cluster nodes.</p></li></ol><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>+-+---------------+----+---------------+----+---------------+-+
</span></span><span style=display:flex><span>|                           Transport                         |
</span></span><span style=display:flex><span>| +---------------+    +---------------+    +---------------+ |
</span></span><span style=display:flex><span>| |    Cluster    |    |    Cluster    |    |    Cluster    | |
</span></span><span style=display:flex><span>| | communication |    | communication |    | communication | |
</span></span><span style=display:flex><span>| +---------------+    +---------------+    +---------------+ |
</span></span><span style=display:flex><span>+-+---------------+----+-------^-------+----+---------------+-+
</span></span><span style=display:flex><span>                               |
</span></span><span style=display:flex><span>+------------------------------v------------------------------+
</span></span><span style=display:flex><span>|                        Query Processor                      |
</span></span><span style=display:flex><span>|   +-----------------------------------------------------+   |
</span></span><span style=display:flex><span>|   |                     Query Parser                    |   |
</span></span><span style=display:flex><span>|   +-----------------------------------------------------+   |
</span></span><span style=display:flex><span>|   +-----------------------------------------------------+   |
</span></span><span style=display:flex><span>|   |                   Query Optimizer                   |   |
</span></span><span style=display:flex><span>|   +-----------------------------------------------------+   |
</span></span><span style=display:flex><span>+-------------------------------------------------------------+
</span></span></code></pre></div><p>As can be seen from the figure above, the cluster control protocol is located above the data read and write protocol. The client (redis cluster client, IceFireDB-Proxy) obtains the master-slave structure of the cluster nodes according to the cluster status, and selects the relevant master and slave nodes Perform data read and write operations. For the request traffic carried by IceFireDB, it will enter the request processing cycle. During the request processing cycle, it will analyze and optimize the client request.</p><h2 id=protocol-advantages>Protocol advantages
<a class=anchor href=#protocol-advantages>#</a></h2><p>At present, the web2 ecology of RESP protocol clients is very rich, and mainstream computer languages have been fully covered. IceFireDB is firstly compatible with the RESP NoSQL protocol, which can quickly meet the needs of existing application systems to access IceFireDB-NoSQL.</p><p><img src=https://res.cloudinary.com/malloc/image/upload/v1666342853/icefiredb/docs/197156690-fa25a9c2-a8a4-4b69-bacb-dd4ff9915f06_goozlm.png alt=image></p><p>As a decentralized database, IceFireDB is compatible with the RESP protocol, and can hide high technical intelligence from the user layer. Users do not need to understand P2P, RAFT, CRDT, IPFS-LOG and other technologies, and only need to follow the RESP protocol to choose the appropriate client for application You can operate the database to read and write, and quickly meet the access and transformation of the business system.</p><h2 id=data-control-protocol>Data control protocol
<a class=anchor href=#data-control-protocol>#</a></h2><table><thead><tr><th>Strings</th><th>Hashes</th><th>Lists</th><th>Sets</th><th>Sorted Sets</th></tr></thead><tbody><tr><td>APPEND</td><td>HSET</td><td>RPUSH</td><td>SADD</td><td>ZADD</td></tr><tr><td>BITCOUNT</td><td>HGET</td><td>LPOP</td><td>SCARD</td><td>ZCARD</td></tr><tr><td>BITOP</td><td>HDEL</td><td>LINDEX</td><td>SDIFF</td><td>ZCOUNT</td></tr><tr><td>BITPOS</td><td>HEXISTS</td><td>LPUSH</td><td>SDIFFSTORE</td><td>ZREM</td></tr><tr><td>DECR</td><td>HGETALL</td><td>RPOP</td><td>SINTER</td><td>ZCLEAR</td></tr><tr><td>DECRBY</td><td>HINCRBY</td><td>LRANGE</td><td>SINTERSTORE</td><td>ZRANK</td></tr><tr><td>DEL</td><td>HKEYS</td><td>LSET</td><td>SISMEMBER</td><td>ZRANGE</td></tr><tr><td>EXISTS</td><td>HLEN</td><td>LLEN</td><td>SMEMBERS</td><td>ZREVRANGE</td></tr><tr><td>GET</td><td>HMGET</td><td>RPOPLPUSH</td><td>SREM</td><td>ZSCORE</td></tr><tr><td>GETBIT</td><td>HMSET</td><td>LCLEAR</td><td>SUNION</td><td>ZINCRBY</td></tr><tr><td>SETBIT</td><td>HSETEX</td><td>LCLEAR</td><td>SUNIONSTORE</td><td>ZREVRANK</td></tr><tr><td>GETRANGE</td><td>HSTRLEN</td><td>LMCLEAR</td><td>SCLEAR</td><td>ZRANGEBYSCORE</td></tr><tr><td>GETSET</td><td>HVALS</td><td>LEXPIRE</td><td>SMCLEAR</td><td>ZREVRANGEBYSCORE</td></tr><tr><td>INCR</td><td>HCLEAR</td><td>LEXPIREAT</td><td>SEXPIRE</td><td>ZREMRANGEBYSCORE</td></tr><tr><td>EXISTS</td><td>HMCLEAR</td><td>LKEYEXISTS</td><td>SEXPIRE</td><td>ZREMRANGEBYRANK</td></tr><tr><td>GET</td><td>HEXPIRE</td><td>LTRIM</td><td>SEXPIREAT</td><td></td></tr><tr><td>GETBIT</td><td>HEXPIREAT</td><td>LTTL</td><td>STTL</td><td></td></tr><tr><td>SETBIT</td><td>HKEYEXIST</td><td></td><td>SPERSIST</td><td></td></tr><tr><td>GETRANGE</td><td>HTTL</td><td></td><td>SKEYEXISTS</td><td></td></tr><tr><td>GETSET</td><td></td><td></td><td></td><td></td></tr><tr><td>INCRBY</td><td></td><td></td><td></td><td></td></tr><tr><td>GET</td><td></td><td></td><td></td><td></td></tr><tr><td>MGET</td><td></td><td></td><td></td><td></td></tr><tr><td>MSET</td><td></td><td></td><td></td><td></td></tr><tr><td>SET</td><td></td><td></td><td></td><td></td></tr><tr><td>SETEX</td><td></td><td></td><td></td><td></td></tr><tr><td>SETEXAT</td><td></td><td></td><td></td><td></td></tr><tr><td>SETRANGE</td><td></td><td></td><td></td><td></td></tr><tr><td>EXPIRE</td><td></td><td></td><td></td><td></td></tr><tr><td>EXPIREAT</td><td></td><td></td><td></td><td></td></tr><tr><td>TTL</td><td></td><td></td><td></td><td></td></tr></tbody></table><h2 id=cluster-control-protocol>Cluster control protocol
<a class=anchor href=#cluster-control-protocol>#</a></h2><p>IceFireDB-NoSQL integrates some Redis cluster status instructions in the RAFT parallel database scenario.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-sh data-lang=sh><span style=display:flex><span>VERSION                                 <span style=color:#75715e># show the application version</span>
</span></span><span style=display:flex><span>MACHINE                                 <span style=color:#75715e># show information about the state machine</span>
</span></span><span style=display:flex><span>RAFT LEADER                             <span style=color:#75715e># show the address of the current raft leader</span>
</span></span><span style=display:flex><span>RAFT INFO <span style=color:#f92672>[</span>pattern<span style=color:#f92672>]</span>                     <span style=color:#75715e># show information about the raft server and cluster</span>
</span></span><span style=display:flex><span>RAFT SERVER LIST                        <span style=color:#75715e># show all servers in cluster</span>
</span></span><span style=display:flex><span>RAFT SERVER ADD id address              <span style=color:#75715e># add a server to cluster</span>
</span></span><span style=display:flex><span>RAFT SERVER REMOVE id                   <span style=color:#75715e># remove a server from the cluster</span>
</span></span><span style=display:flex><span>RAFT SNAPSHOT NOW                       <span style=color:#75715e># make a snapshot of the data</span>
</span></span><span style=display:flex><span>RAFT SNAPSHOT LIST                      <span style=color:#75715e># show a list of all snapshots on server</span>
</span></span><span style=display:flex><span>RAFT SNAPSHOT FILE id                   <span style=color:#75715e># show the file path of a snapshot on server</span>
</span></span><span style=display:flex><span>RAFT SNAPSHOT READ id <span style=color:#f92672>[</span>RANGE start end<span style=color:#f92672>]</span> <span style=color:#75715e># download all or part of a snapshot</span>
</span></span></code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#protocol-advantages>Protocol advantages</a></li><li><a href=#data-control-protocol>Data control protocol</a></li><li><a href=#cluster-control-protocol>Cluster control protocol</a></li></ul></nav></div></aside></main></body></html>