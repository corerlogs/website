<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="redhub-frame # Project introduction # High-performance Redis-Server multi-threaded framework, based on RawEpoll model.
Features # Ultra high performance Fully multi-threaded support Low CPU resource consumption Compatible with redis protocol Create a Redis compatible server with RawEpoll model in Go Installing # go get -u github.com/IceFireDB/redhub Example # Here is a simple framework usage example,support the following redis commands:
SET key value GET key DEL key PING QUIT You can run this example in terminal:"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:type" content="website"><meta property="og:image" content="https://res.cloudinary.com/malloc/image/upload/v1666510486/icefiredb/logo_z8koem.png"><meta property="og:title" content="redhub-frame"><meta property="og:description" content="redhub-frame # Project introduction # High-performance Redis-Server multi-threaded framework, based on RawEpoll model.
Features # Ultra high performance Fully multi-threaded support Low CPU resource consumption Compatible with redis protocol Create a Redis compatible server with RawEpoll model in Go Installing # go get -u github.com/IceFireDB/redhub Example # Here is a simple framework usage example,support the following redis commands:
SET key value GET key DEL key PING QUIT You can run this example in terminal:"><meta property="og:type" content="article"><meta property="og:url" content="https://icorer.com/icorer_docs/doccenter/redistun/develop/redhub/"><meta property="article:section" content="DocCenter"><title>redhub-frame | 工匠之芯-文档中心</title><link rel=manifest href=/icorer_docs/manifest.json><link rel=icon href=/icorer_docs/favicon.ico type=image/x-icon><link rel=stylesheet href=/icorer_docs/book.min.46181bc93375ba932026e753b37c40e6ff8bb16a9ef770c78bcc663e4577b1ba.css integrity="sha256-RhgbyTN1upMgJudTs3xA5v+LsWqe93DHi8xmPkV3sbo=" crossorigin=anonymous><script defer src=/icorer_docs/flexsearch.min.js></script>
<script defer src=/icorer_docs/en.search.min.d96be161117e105e2baa9f99837584c6fb294755df57559aab605279890791d6.js integrity="sha256-2WvhYRF+EF4rqp+Zg3WExvspR1XfV1Waq2BSeYkHkdY=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/icorer_docs/><span>工匠之芯-文档中心</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://icorer.com/ target=_blank rel=noopener>工匠之芯</a></li><li><a href=https://github.com/gitsrc target=_blank rel=noopener>Open Source</a></li></ul><ul><li class=book-section-flat><a href=https://icorer.com/icorer_docs/doccenter/>项目总览</a><ul><li><input type=checkbox id=section-aed24396fef473497b12e93db0aa8548 class=toggle>
<label for=section-aed24396fef473497b12e93db0aa8548 class="flex justify-between"><a href=https://icorer.com/icorer_docs/doccenter/redishub/>RedisHub</a></label><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/>系统设计</a><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/1.1/>1.1基础运行框架</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/1.2/>1.2配置解析器</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/1.3/>1.3通信组件</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/1.4/>1.4 协议解析器与拦截器</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/1.5/>1.5 NetHandle组件</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/1.6/>1.5 集群 MSET 指令支持</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/1.7/>1.7 集群 MGET 指令支持</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/1.8/>1.9 Redis集群状态更新</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/1.9/>1.8 TCP连接池</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/designs/1.10/>1.10 RESP协议解析</a></li></ul></li><li><span>系统模块测试</span><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/module_test/2.1/>2.1 NetHandle组件测试</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/module_test/2.2/>2.2 中间件完整测试</a></li></ul></li><li><span>中间件部署</span><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/deploy/3.1/>3.1 部署文档</a></li></ul></li><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/system_access/>系统接入</a><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redishub/system_access/4.1/>4.1 phpredis对接redishub</a></li></ul></li></ul></li><li><input type=checkbox id=section-1453ce2c5ecb8c18c2860dade55163de class=toggle>
<label for=section-1453ce2c5ecb8c18c2860dade55163de class="flex justify-between"><a role=button>PulseFlow</a></label><ul><li><input type=checkbox id=section-b349698f86361cb77fa3daf6029bb134 class=toggle>
<label for=section-b349698f86361cb77fa3daf6029bb134 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://icorer.com/icorer_docs/doccenter/pulseflow/architecture/overview/>OverView</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/pulseflow/architecture/network/>NetWork</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/pulseflow/architecture/storage/>Storage</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/pulseflow/architecture/protocol/>Protocol</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/pulseflow/architecture/codec/>Codec</a></li></ul></li></ul></li><li><input type=checkbox id=section-14e1ec26ce57d625211daa6855b123ba class=toggle checked>
<label for=section-14e1ec26ce57d625211daa6855b123ba class="flex justify-between"><a role=button>RedisTun</a></label><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/quick_start/>Quick Start</a><ul></ul></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/designs/>Designs</a><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/designs/network/>Network layer</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/designs/storage/>Storage layer</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/designs/protocol/>Protocol layer</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/designs/codec/>Codec layer</a></li></ul></li><li><span>Develop</span><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/develop/icefiredb-crdt-kv/>icefiredb-crdt-kv</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/develop/icefiredb-ipfs-log/>icefiredb-ipfs-log</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/develop/icefiredb_proxy/>icefiredb-proxy</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/develop/redhub/ class=active>redhub-frame</a></li></ul></li><li><span>Project Comparison</span><ul><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/project-comparison/orbitdb/>OrbitDB</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/redistun/project-comparison/threaddb/>ThreadDB</a></li></ul></li></ul></li><li><input type=checkbox id=section-404d707d87f9ef4c7b157ec13db25c80 class=toggle>
<label for=section-404d707d87f9ef4c7b157ec13db25c80 class="flex justify-between"><a role=button>LogDarts</a></label><ul><li><input type=checkbox id=section-658ed1b71722eedc365fde2c5579594f class=toggle>
<label for=section-658ed1b71722eedc365fde2c5579594f class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://icorer.com/icorer_docs/doccenter/logdarts/architecture/overview/>OverView</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/logdarts/architecture/network/>NetWork</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/logdarts/architecture/storage/>Storage</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/logdarts/architecture/protocol/>Protocol</a></li></ul></li></ul></li><li><input type=checkbox id=section-a22dab337e8b55a3f7712060bcd10bb9 class=toggle>
<label for=section-a22dab337e8b55a3f7712060bcd10bb9 class="flex justify-between"><a role=button>AK-2019</a></label><ul><li><input type=checkbox id=section-549f710dc768b95bd2287ab37bb3db61 class=toggle>
<label for=section-549f710dc768b95bd2287ab37bb3db61 class="flex justify-between"><a role=button>Architecture</a></label><ul><li><a href=https://icorer.com/icorer_docs/doccenter/ak-2019/architecture/overview/>OverView</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/ak-2019/architecture/network/>NetWork</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/ak-2019/architecture/storage/>Storage</a></li><li><a href=https://icorer.com/icorer_docs/doccenter/ak-2019/architecture/protocol/>Protocol</a></li></ul></li></ul></li></ul></li></ul></nav><script>(function(){var e=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(){localStorage.setItem("menu.scrollTop",e.scrollTop)}),e.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/icorer_docs/svg/menu.svg class=book-icon alt=Menu></label>
<strong>redhub-frame</strong>
<label for=toc-control><img src=/icorer_docs/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#project-introduction>Project introduction</a></li><li><a href=#features>Features</a></li><li><a href=#installing>Installing</a></li><li><a href=#example>Example</a></li><li><a href=#benchmarks>Benchmarks</a><ul><li><a href=#redis-server503-single-threaded-no-disk-persistence>【Redis-server5.0.3】 Single-threaded, no disk persistence.</a></li><li><a href=#redis-server625-single-threaded-no-disk-persistence>【Redis-server6.2.5】 Single-threaded, no disk persistence.</a></li><li><a href=#redis-server625-multi-threaded-no-disk-persistence>【Redis-server6.2.5】 Multi-threaded, no disk persistence.</a></li><li><a href=#redcon-multi-threaded-no-disk-persistence>【RedCon】 Multi-threaded, no disk persistence</a></li><li><a href=#redhub-multi-threaded-no-disk-persistence>【RedHub】 Multi-threaded, no disk persistence</a></li></ul></li></ul></nav></aside></header><article class=markdown><h1 id=redhub-frame>redhub-frame
<a class=anchor href=#redhub-frame>#</a></h1><h2 id=project-introduction>Project introduction
<a class=anchor href=#project-introduction>#</a></h2><p>High-performance Redis-Server multi-threaded framework, based on RawEpoll model.</p><h2 id=features>Features
<a class=anchor href=#features>#</a></h2><ul><li>Ultra high performance</li><li>Fully multi-threaded support</li><li>Low CPU resource consumption</li><li>Compatible with redis protocol</li><li>Create a Redis compatible server with RawEpoll model in Go</li></ul><h2 id=installing>Installing
<a class=anchor href=#installing>#</a></h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>go</span> <span style=color:#a6e22e>get</span> <span style=color:#f92672>-</span><span style=color:#a6e22e>u</span> <span style=color:#a6e22e>github</span>.<span style=color:#a6e22e>com</span><span style=color:#f92672>/</span><span style=color:#a6e22e>IceFireDB</span><span style=color:#f92672>/</span><span style=color:#a6e22e>redhub</span>
</span></span></code></pre></div><h2 id=example>Example
<a class=anchor href=#example>#</a></h2><p>Here is a simple framework usage example,support the following redis commands:</p><ul><li>SET key value</li><li>GET key</li><li>DEL key</li><li>PING</li><li>QUIT</li></ul><p>You can run this example in terminal:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-golang data-lang=golang><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;flag&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;fmt&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;log&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;strings&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;sync&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;net/http&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>_</span> <span style=color:#e6db74>&#34;net/http/pprof&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;github.com/IceFireDB/redhub&#34;</span>
</span></span><span style=display:flex><span>	<span style=color:#e6db74>&#34;github.com/IceFireDB/redhub/pkg/resp&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>mu</span> <span style=color:#a6e22e>sync</span>.<span style=color:#a6e22e>RWMutex</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>items</span> = make(<span style=color:#66d9ef>map</span>[<span style=color:#66d9ef>string</span>][]<span style=color:#66d9ef>byte</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>network</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>addr</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>multicore</span> <span style=color:#66d9ef>bool</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>reusePort</span> <span style=color:#66d9ef>bool</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>pprofDebug</span> <span style=color:#66d9ef>bool</span>
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>pprofAddr</span> <span style=color:#66d9ef>string</span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>network</span>, <span style=color:#e6db74>&#34;network&#34;</span>, <span style=color:#e6db74>&#34;tcp&#34;</span>, <span style=color:#e6db74>&#34;server network (default \&#34;tcp\&#34;)&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>addr</span>, <span style=color:#e6db74>&#34;addr&#34;</span>, <span style=color:#e6db74>&#34;127.0.0.1:6380&#34;</span>, <span style=color:#e6db74>&#34;server addr (default \&#34;:6380\&#34;)&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>BoolVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>multicore</span>, <span style=color:#e6db74>&#34;multicore&#34;</span>, <span style=color:#66d9ef>true</span>, <span style=color:#e6db74>&#34;multicore&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>BoolVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>reusePort</span>, <span style=color:#e6db74>&#34;reusePort&#34;</span>, <span style=color:#66d9ef>false</span>, <span style=color:#e6db74>&#34;reusePort&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>BoolVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>pprofDebug</span>, <span style=color:#e6db74>&#34;pprofDebug&#34;</span>, <span style=color:#66d9ef>false</span>, <span style=color:#e6db74>&#34;open pprof&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>StringVar</span>(<span style=color:#f92672>&amp;</span><span style=color:#a6e22e>pprofAddr</span>, <span style=color:#e6db74>&#34;pprofAddr&#34;</span>, <span style=color:#e6db74>&#34;:8888&#34;</span>, <span style=color:#e6db74>&#34;pprof address&#34;</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>flag</span>.<span style=color:#a6e22e>Parse</span>()
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>pprofDebug</span> {
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>go</span> <span style=color:#66d9ef>func</span>() {
</span></span><span style=display:flex><span>			<span style=color:#a6e22e>http</span>.<span style=color:#a6e22e>ListenAndServe</span>(<span style=color:#a6e22e>pprofAddr</span>, <span style=color:#66d9ef>nil</span>)
</span></span><span style=display:flex><span>		}()
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>protoAddr</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>fmt</span>.<span style=color:#a6e22e>Sprintf</span>(<span style=color:#e6db74>&#34;%s://%s&#34;</span>, <span style=color:#a6e22e>network</span>, <span style=color:#a6e22e>addr</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>option</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>redhub</span>.<span style=color:#a6e22e>Options</span>{
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>Multicore</span>: <span style=color:#a6e22e>multicore</span>,
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>ReusePort</span>: <span style=color:#a6e22e>reusePort</span>,
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>rh</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>redhub</span>.<span style=color:#a6e22e>NewRedHub</span>(
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>c</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>redhub</span>.<span style=color:#a6e22e>Conn</span>) (<span style=color:#a6e22e>out</span> []<span style=color:#66d9ef>byte</span>, <span style=color:#a6e22e>action</span> <span style=color:#a6e22e>redhub</span>.<span style=color:#a6e22e>Action</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>c</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>redhub</span>.<span style=color:#a6e22e>Conn</span>, <span style=color:#a6e22e>err</span> <span style=color:#66d9ef>error</span>) (<span style=color:#a6e22e>action</span> <span style=color:#a6e22e>redhub</span>.<span style=color:#a6e22e>Action</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span>
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>		<span style=color:#66d9ef>func</span>(<span style=color:#a6e22e>cmd</span> <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>Command</span>, <span style=color:#a6e22e>out</span> []<span style=color:#66d9ef>byte</span>) ([]<span style=color:#66d9ef>byte</span>, <span style=color:#a6e22e>redhub</span>.<span style=color:#a6e22e>Action</span>) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>status</span> <span style=color:#a6e22e>redhub</span>.<span style=color:#a6e22e>Action</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>switch</span> <span style=color:#a6e22e>strings</span>.<span style=color:#a6e22e>ToLower</span>(string(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>0</span>])) {
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>default</span>:
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendError</span>(<span style=color:#a6e22e>out</span>, <span style=color:#e6db74>&#34;ERR unknown command &#39;&#34;</span><span style=color:#f92672>+</span>string(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>0</span>])<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;&#39;&#34;</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;ping&#34;</span>:
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendString</span>(<span style=color:#a6e22e>out</span>, <span style=color:#e6db74>&#34;PONG&#34;</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;quit&#34;</span>:
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendString</span>(<span style=color:#a6e22e>out</span>, <span style=color:#e6db74>&#34;OK&#34;</span>)
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>status</span> = <span style=color:#a6e22e>redhub</span>.<span style=color:#a6e22e>Close</span>
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;set&#34;</span>:
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>3</span> {
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendError</span>(<span style=color:#a6e22e>out</span>, <span style=color:#e6db74>&#34;ERR wrong number of arguments for &#39;&#34;</span><span style=color:#f92672>+</span>string(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>0</span>])<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;&#39; command&#34;</span>)
</span></span><span style=display:flex><span>					<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>				}
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>mu</span>.<span style=color:#a6e22e>Lock</span>()
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>items</span>[string(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>1</span>])] = <span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>2</span>]
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>mu</span>.<span style=color:#a6e22e>Unlock</span>()
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendString</span>(<span style=color:#a6e22e>out</span>, <span style=color:#e6db74>&#34;OK&#34;</span>)
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;get&#34;</span>:
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>2</span> {
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendError</span>(<span style=color:#a6e22e>out</span>, <span style=color:#e6db74>&#34;ERR wrong number of arguments for &#39;&#34;</span><span style=color:#f92672>+</span>string(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>0</span>])<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;&#39; command&#34;</span>)
</span></span><span style=display:flex><span>					<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>				}
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>mu</span>.<span style=color:#a6e22e>RLock</span>()
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>val</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>items</span>[string(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>1</span>])]
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>mu</span>.<span style=color:#a6e22e>RUnlock</span>()
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> !<span style=color:#a6e22e>ok</span> {
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendNull</span>(<span style=color:#a6e22e>out</span>)
</span></span><span style=display:flex><span>				} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendBulk</span>(<span style=color:#a6e22e>out</span>, <span style=color:#a6e22e>val</span>)
</span></span><span style=display:flex><span>				}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;del&#34;</span>:
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> len(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>) <span style=color:#f92672>!=</span> <span style=color:#ae81ff>2</span> {
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendError</span>(<span style=color:#a6e22e>out</span>, <span style=color:#e6db74>&#34;ERR wrong number of arguments for &#39;&#34;</span><span style=color:#f92672>+</span>string(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>0</span>])<span style=color:#f92672>+</span><span style=color:#e6db74>&#34;&#39; command&#34;</span>)
</span></span><span style=display:flex><span>					<span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>				}
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>mu</span>.<span style=color:#a6e22e>Lock</span>()
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>ok</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>items</span>[string(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>1</span>])]
</span></span><span style=display:flex><span>				delete(<span style=color:#a6e22e>items</span>, string(<span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>1</span>]))
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>mu</span>.<span style=color:#a6e22e>Unlock</span>()
</span></span><span style=display:flex><span>				<span style=color:#66d9ef>if</span> !<span style=color:#a6e22e>ok</span> {
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendInt</span>(<span style=color:#a6e22e>out</span>, <span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>				} <span style=color:#66d9ef>else</span> {
</span></span><span style=display:flex><span>					<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendInt</span>(<span style=color:#a6e22e>out</span>, <span style=color:#ae81ff>1</span>)
</span></span><span style=display:flex><span>				}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;config&#34;</span>:
</span></span><span style=display:flex><span>				<span style=color:#75715e>// This simple (blank) response is only here to allow for the
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>				<span style=color:#75715e>// redis-benchmark command to work with this example.
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>				<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendArray</span>(<span style=color:#a6e22e>out</span>, <span style=color:#ae81ff>2</span>)
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendBulk</span>(<span style=color:#a6e22e>out</span>, <span style=color:#a6e22e>cmd</span>.<span style=color:#a6e22e>Args</span>[<span style=color:#ae81ff>2</span>])
</span></span><span style=display:flex><span>				<span style=color:#a6e22e>out</span> = <span style=color:#a6e22e>resp</span>.<span style=color:#a6e22e>AppendBulkString</span>(<span style=color:#a6e22e>out</span>, <span style=color:#e6db74>&#34;&#34;</span>)
</span></span><span style=display:flex><span>			}
</span></span><span style=display:flex><span>			<span style=color:#66d9ef>return</span> <span style=color:#a6e22e>out</span>, <span style=color:#a6e22e>status</span>
</span></span><span style=display:flex><span>		},
</span></span><span style=display:flex><span>	)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Printf</span>(<span style=color:#e6db74>&#34;started redhub server at %s&#34;</span>, <span style=color:#a6e22e>addr</span>)
</span></span><span style=display:flex><span>	<span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>redhub</span>.<span style=color:#a6e22e>ListendAndServe</span>(<span style=color:#a6e22e>protoAddr</span>, <span style=color:#a6e22e>option</span>, <span style=color:#a6e22e>rh</span>)
</span></span><span style=display:flex><span>	<span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>		<span style=color:#a6e22e>log</span>.<span style=color:#a6e22e>Fatal</span>(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>	}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=benchmarks>Benchmarks
<a class=anchor href=#benchmarks>#</a></h2><pre tabindex=0><code>Machine information
        OS : Debian Buster 10.6 64bit 
       CPU : 8 CPU cores
    Memory : 64.0 GiB

Go Version : go1.16.5 linux/amd64
</code></pre><h3 id=redis-server503-single-threaded-no-disk-persistence>【Redis-server5.0.3】 Single-threaded, no disk persistence.
<a class=anchor href=#redis-server503-single-threaded-no-disk-persistence>#</a></h3><pre tabindex=0><code>$ ./redis-server --port 6380 --appendonly no
</code></pre><pre tabindex=0><code>$ redis-benchmark -h 127.0.0.1 -p 6380 -n 50000000 -t set,get -c 512 -P 1024 -q
SET: 2306060.50 requests per second
GET: 3096742.25 requests per second
</code></pre><h3 id=redis-server625-single-threaded-no-disk-persistence>【Redis-server6.2.5】 Single-threaded, no disk persistence.
<a class=anchor href=#redis-server625-single-threaded-no-disk-persistence>#</a></h3><pre tabindex=0><code>$ ./redis-server --port 6380 --appendonly no
</code></pre><pre tabindex=0><code>$ redis-benchmark -h 127.0.0.1 -p 6380 -n 50000000 -t set,get -c 512 -P 1024 -q
SET: 2076325.75 requests per second
GET: 2652801.50 requests per second
</code></pre><h3 id=redis-server625-multi-threaded-no-disk-persistence>【Redis-server6.2.5】 Multi-threaded, no disk persistence.
<a class=anchor href=#redis-server625-multi-threaded-no-disk-persistence>#</a></h3><pre tabindex=0><code>io-threads-do-reads yes
io-threads 8
$ ./redis-server redis.conf
</code></pre><pre tabindex=0><code>$ redis-benchmark -h 127.0.0.1 -p 6379 -n 50000000 -t set,get -c 512 -P 1024 -q
SET: 1944692.88 requests per second
GET: 2375184.00 requests per second
</code></pre><h3 id=redcon-multi-threaded-no-disk-persistence>【RedCon】 Multi-threaded, no disk persistence
<a class=anchor href=#redcon-multi-threaded-no-disk-persistence>#</a></h3><pre tabindex=0><code>$ go run example/clone.go
</code></pre><pre tabindex=0><code>$ redis-benchmark -h 127.0.0.1 -p 6380 -n 50000000 -t set,get -c 512 -P 1024 -q
SET: 2332742.25 requests per second
GET: 14654162.00 requests per second
</code></pre><h3 id=redhub-multi-threaded-no-disk-persistence>【RedHub】 Multi-threaded, no disk persistence
<a class=anchor href=#redhub-multi-threaded-no-disk-persistence>#</a></h3><pre tabindex=0><code>$ go run example/server.go
</code></pre><pre tabindex=0><code>$ redis-benchmark -h 127.0.0.1 -p 6380 -n 50000000 -t set,get -c 512 -P 1024 -q
SET: 4087305.00 requests per second
GET: 16490765.00 requests per second
</code></pre><center><img width=550 alt=image src=https://res.cloudinary.com/malloc/image/upload/v1669104318/icefiredb/docs/134836128-423fd389-0fae-4e37-81c2-3b0066ed5f56_bk9hcs.png></center>
<center><img width=550 alt=image src=https://res.cloudinary.com/malloc/image/upload/v1669104334/icefiredb/docs/134836167-37c41c77-d77e-4ca8-96cb-4bab8ab65fa0_cu9icn.png></center></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function e(e){const t=window.getSelection(),n=document.createRange();n.selectNodeContents(e),t.removeAllRanges(),t.addRange(n)}document.querySelectorAll("pre code").forEach(t=>{t.addEventListener("click",function(){e(t.parentElement),navigator.clipboard&&navigator.clipboard.writeText(t.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents><ul><li><a href=#project-introduction>Project introduction</a></li><li><a href=#features>Features</a></li><li><a href=#installing>Installing</a></li><li><a href=#example>Example</a></li><li><a href=#benchmarks>Benchmarks</a><ul><li><a href=#redis-server503-single-threaded-no-disk-persistence>【Redis-server5.0.3】 Single-threaded, no disk persistence.</a></li><li><a href=#redis-server625-single-threaded-no-disk-persistence>【Redis-server6.2.5】 Single-threaded, no disk persistence.</a></li><li><a href=#redis-server625-multi-threaded-no-disk-persistence>【Redis-server6.2.5】 Multi-threaded, no disk persistence.</a></li><li><a href=#redcon-multi-threaded-no-disk-persistence>【RedCon】 Multi-threaded, no disk persistence</a></li><li><a href=#redhub-multi-threaded-no-disk-persistence>【RedHub】 Multi-threaded, no disk persistence</a></li></ul></li></ul></nav></div></aside></main></body></html>