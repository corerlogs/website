<!doctype html><html lang=en><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="ie=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=icon type=image/ico sizes=16x16 href=/icorer_blog/img/favicon.ico><meta property="og:image" content="https://res.cloudinary.com/malloc/image/upload/v1669271757/icorer.com/34047788_pepere.jpg"><title>开源项目：PulseFLow 性能跟踪扩展 | 笔迹-工匠之芯</title><meta name=author content="LB"><meta name=description content="背景描述随着公司PHP项目体的不断增大，随着不同工程师的功能迭代，如何有效获取PHP项目的执行性能，对于系统整体模块显得异常重要，PulseFlow是一个性能跟踪扩展，它可以在程序员无感知的情况下有效跟踪每一个函数的执行效率，主要分析CPU时间消耗、内存大小消耗，这个组件除了能够快速记录每个函数体的性能信息，还具备一系列的发送机制，主要包括共享内存队列（System V 和 Posix）、UDP、Unix Domain Socket 等模式。
编译安装此为PHP扩展，按照正常的扩展安装，我们需要执行以下几步操作：
git clone https://github.com/gitsrc/PulseFlow.git 进入源码目录 phpize ./configure &ndash;with-php-config= （ php-config文件路径） CFLAGS=&rsquo;-g -lrt&rsquo; CXXFLAGS=&rsquo;-lrt' make make install 编译特别注意由于在扩展中使用了 posix 共享内存队列，所以我们编译时需要引入lrt库，上面在configure过程中附加的 CFLAGS 和 CXXFLAGS 参数用来给Makefile中的相应字段添加 -lrt，最终构造完后的Makefile对应配置应该为：
1CFLAGS = -g -lrt -O0 2 3CXXFLAGS = -lrt -g -O0 设计点1：PHP INI 配置选项PulseFlow由于是一个基于C语言的PHP扩展，为了保持程序体的扩展性，配置选项一律从php.ini文件中读取，本节将描述所有与扩展程序有关系的配置信息。
1.1 扩展功能开关参数 （PulseFlow.enabled）1.1.1 参数介绍这个参数是插件的功能开关，属于布尔类型，有效参数如下，默认 false：
true：开启 false：关闭 1.2 日志功能开关参数 （PulseFlow.debug）1.2.1 参数介绍这个参数是控制插件是否向页面输出调试信息，有效参数如下，默认 false：
true：开启 false：关闭 1.3 禁止跟踪函数列表 （PulseFlow.disable_trace_functions）1.3.1 参数介绍这个参数是一个逗号分隔的字符串，代表一系列函数列表，这个函数列表内的函数不进行性能跟踪，默认空字符串。
配置样例：PulseFlow.disable_trace_functions = &ldquo;getLoader,findFile,loadClassLoader,getInitializer,findFileWithExtension,&rdquo;
1.4 禁止跟踪类列表 （PulseFlow.disable_trace_class）1.4.1 参数介绍这个参数是一个逗号分隔的字符串，代表一系列类列表，这个类列表内的类不进行性能跟踪，默认空字符串。"><meta name=keywords content="blog,博客,工匠之芯,笔迹-工匠之芯"><meta name=twitter:card content="summary"><meta name=twitter:title content="开源项目：PulseFLow 性能跟踪扩展"><meta name=twitter:description content="背景描述随着公司PHP项目体的不断增大，随着不同工程师的功能迭代，如何有效获取PHP项目的执行性能，对于系统整体模块显得异常重要，PulseFlow是一个性能跟踪扩展，它可以在程序员无感知的情况下有效跟踪每一个函数的执行效率，主要分析CPU时间消耗、内存大小消耗，这个组件除了能够快速记录每个函数体的性能信息，还具备一系列的发送机制，主要包括共享内存队列（System V 和 Posix）、UDP、Unix Domain Socket 等模式。
编译安装此为PHP扩展，按照正常的扩展安装，我们需要执行以下几步操作：
git clone https://github.com/gitsrc/PulseFlow.git 进入源码目录 phpize ./configure &ndash;with-php-config= （ php-config文件路径） CFLAGS=&rsquo;-g -lrt&rsquo; CXXFLAGS=&rsquo;-lrt' make make install 编译特别注意由于在扩展中使用了 posix 共享内存队列，所以我们编译时需要引入lrt库，上面在configure过程中附加的 CFLAGS 和 CXXFLAGS 参数用来给Makefile中的相应字段添加 -lrt，最终构造完后的Makefile对应配置应该为：
1CFLAGS = -g -lrt -O0 2 3CXXFLAGS = -lrt -g -O0 设计点1：PHP INI 配置选项PulseFlow由于是一个基于C语言的PHP扩展，为了保持程序体的扩展性，配置选项一律从php.ini文件中读取，本节将描述所有与扩展程序有关系的配置信息。
1.1 扩展功能开关参数 （PulseFlow.enabled）1.1.1 参数介绍这个参数是插件的功能开关，属于布尔类型，有效参数如下，默认 false：
true：开启 false：关闭 1.2 日志功能开关参数 （PulseFlow.debug）1.2.1 参数介绍这个参数是控制插件是否向页面输出调试信息，有效参数如下，默认 false：
true：开启 false：关闭 1.3 禁止跟踪函数列表 （PulseFlow.disable_trace_functions）1.3.1 参数介绍这个参数是一个逗号分隔的字符串，代表一系列函数列表，这个函数列表内的函数不进行性能跟踪，默认空字符串。
配置样例：PulseFlow.disable_trace_functions = &ldquo;getLoader,findFile,loadClassLoader,getInitializer,findFileWithExtension,&rdquo;
1.4 禁止跟踪类列表 （PulseFlow.disable_trace_class）1.4.1 参数介绍这个参数是一个逗号分隔的字符串，代表一系列类列表，这个类列表内的类不进行性能跟踪，默认空字符串。"><meta property="og:title" content="开源项目：PulseFLow 性能跟踪扩展"><meta property="og:description" content="背景描述随着公司PHP项目体的不断增大，随着不同工程师的功能迭代，如何有效获取PHP项目的执行性能，对于系统整体模块显得异常重要，PulseFlow是一个性能跟踪扩展，它可以在程序员无感知的情况下有效跟踪每一个函数的执行效率，主要分析CPU时间消耗、内存大小消耗，这个组件除了能够快速记录每个函数体的性能信息，还具备一系列的发送机制，主要包括共享内存队列（System V 和 Posix）、UDP、Unix Domain Socket 等模式。
编译安装此为PHP扩展，按照正常的扩展安装，我们需要执行以下几步操作：
git clone https://github.com/gitsrc/PulseFlow.git 进入源码目录 phpize ./configure &ndash;with-php-config= （ php-config文件路径） CFLAGS=&rsquo;-g -lrt&rsquo; CXXFLAGS=&rsquo;-lrt' make make install 编译特别注意由于在扩展中使用了 posix 共享内存队列，所以我们编译时需要引入lrt库，上面在configure过程中附加的 CFLAGS 和 CXXFLAGS 参数用来给Makefile中的相应字段添加 -lrt，最终构造完后的Makefile对应配置应该为：
1CFLAGS = -g -lrt -O0 2 3CXXFLAGS = -lrt -g -O0 设计点1：PHP INI 配置选项PulseFlow由于是一个基于C语言的PHP扩展，为了保持程序体的扩展性，配置选项一律从php.ini文件中读取，本节将描述所有与扩展程序有关系的配置信息。
1.1 扩展功能开关参数 （PulseFlow.enabled）1.1.1 参数介绍这个参数是插件的功能开关，属于布尔类型，有效参数如下，默认 false：
true：开启 false：关闭 1.2 日志功能开关参数 （PulseFlow.debug）1.2.1 参数介绍这个参数是控制插件是否向页面输出调试信息，有效参数如下，默认 false：
true：开启 false：关闭 1.3 禁止跟踪函数列表 （PulseFlow.disable_trace_functions）1.3.1 参数介绍这个参数是一个逗号分隔的字符串，代表一系列函数列表，这个函数列表内的函数不进行性能跟踪，默认空字符串。
配置样例：PulseFlow.disable_trace_functions = &ldquo;getLoader,findFile,loadClassLoader,getInitializer,findFileWithExtension,&rdquo;
1.4 禁止跟踪类列表 （PulseFlow.disable_trace_class）1.4.1 参数介绍这个参数是一个逗号分隔的字符串，代表一系列类列表，这个类列表内的类不进行性能跟踪，默认空字符串。"><meta property="og:type" content="article"><meta property="og:url" content="https://icorer.com/icorer_blog/posts/open-source-project-pulseflow-performance-tracking-extension/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2018-07-25T13:48:18+08:00"><meta property="article:modified_time" content="2018-07-25T13:48:18+08:00"><link rel=stylesheet href=/icorer_blog/css/bootstrap.min.css crossorigin=anonymous><link href=//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.6.3/css/font-awesome.min.css rel=stylesheet type=text/css><link rel=stylesheet href=/icorer_blog/sass/main.css><link rel=stylesheet href=/icorer_blog/zoomjs/zoom.min.css><script src=/icorer_blog/js/lazysizes.min.js></script>
<link rel=apple-touch-icon sizes=180x180 href=/icorer_blog/apple-touch-icon.png><link rel=manifest href=/icorer_blog/site.webmanifest></head><body><nav class="navbar navbar-default navbar-custom navbar-fixed-top invert"><div class=container-fluid><div class="navbar-header page-scroll"><button type=button class=navbar-toggle>
<span class=sr-only>Toggle navigation</span>
<span class=icon-bar></span>
<span class=icon-bar></span>
<span class=icon-bar></span></button>
<a class=navbar-brand href=https://icorer.com/icorer_blog/>笔迹-工匠之芯</a></div><div id=huxblog_navbar><div class=navbar-collapse><ul class="nav navbar-nav navbar-right"><li><a href=https://icorer.com title=工匠之芯>工匠之芯</a></li><li><a href=https://icorer.com/icorer_about title=关于我>关于我</a></li><li><a href=https://github.com/gitsrc title=开源仓库>开源仓库</a></li><li class=search-icon><a href=javascript:void(0)><i class="fa fa-search"></i></a></li></ul></div></div></div></nav><script>var $body=document.body,$toggle=document.querySelector(".navbar-toggle"),$navbar=document.querySelector("#huxblog_navbar"),$collapse=document.querySelector(".navbar-collapse"),__HuxNav__={close:function(){$navbar.className=" ",setTimeout(function(){$navbar.className.indexOf("in")<0&&($collapse.style.height="0px")},400)},open:function(){$collapse.style.height="auto",$navbar.className+=" in"}};$toggle.addEventListener("click",function(){$navbar.className.indexOf("in")>0?__HuxNav__.close():__HuxNav__.open()}),document.addEventListener("click",function(e){if(e.target==$toggle)return;if(e.target.className=="icon-bar")return;__HuxNav__.close()})</script><div class=search-page><div class=search-icon-close-container><span class=search-icon-close><i class="fa fa-chevron-down"></i></span></div><div class="search-main container"><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><form></form><input type=text id=search-input placeholder=内容搜索...></form><div id=search-results class=mini-post-list></div></div></div></div></div><style type=text/css>header.intro-header{position:relative;background-image:url('')}</style><header class="intro-header style-text"><div class=header-mask></div><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><div class=post-heading><div class=tags><a class=tag href=/icorer_blog/tags/php/ title=PHP>PHP</a>
<a class=tag href=/icorer_blog/tags/php%E5%86%85%E6%A0%B8/ title=PHP内核>PHP内核</a>
<a class=tag href=/icorer_blog/tags/%E5%BA%95%E5%B1%82%E7%A0%94%E7%A9%B6/ title=底层研究>底层研究</a></div><h1>开源项目：PulseFLow 性能跟踪扩展</h1><h2 class=subheading></h2><span class=meta>Posted by LB
on Wed, Jul 25, 2018</span></div></div></div></div></header><article><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
post-container"><h1 id=背景描述>背景描述<a class=anchorjs-link href=#%e8%83%8c%e6%99%af%e6%8f%8f%e8%bf%b0></a></h1><p>随着公司PHP项目体的不断增大，随着不同工程师的功能迭代，如何有效获取PHP项目的执行性能，对于系统整体模块显得异常重要，PulseFlow是一个性能跟踪扩展，它可以在程序员无感知的情况下有效跟踪每一个函数的执行效率，主要分析CPU时间消耗、内存大小消耗，这个组件除了能够快速记录每个函数体的性能信息，还具备一系列的发送机制，主要包括共享内存队列（System V 和 Posix）、UDP、Unix Domain Socket 等模式。</p><h1 id=编译安装>编译安装<a class=anchorjs-link href=#%e7%bc%96%e8%af%91%e5%ae%89%e8%a3%85></a></h1><p>此为PHP扩展，按照正常的扩展安装，我们需要执行以下几步操作：</p><ol><li>git clone <a href=https://github.com/gitsrc/PulseFlow.git target=_blank>https://github.com/gitsrc/PulseFlow.git</a></li><li>进入源码目录</li><li>phpize</li><li>./configure &ndash;with-php-config= （ php-config文件路径） CFLAGS=&rsquo;-g -lrt&rsquo; CXXFLAGS=&rsquo;-lrt'</li><li>make</li><li>make install</li></ol><h2 id=编译特别注意>编译特别注意<a class=anchorjs-link href=#%e7%bc%96%e8%af%91%e7%89%b9%e5%88%ab%e6%b3%a8%e6%84%8f></a></h2><p>由于在扩展中使用了 posix 共享内存队列，所以我们编译时需要引入lrt库，上面在configure过程中附加的 CFLAGS 和 CXXFLAGS 参数用来给Makefile中的相应字段添加 -lrt，最终构造完后的Makefile对应配置应该为：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#282a36;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#8be9fd;font-style:italic>CFLAGS</span> <span style=color:#ff79c6>=</span> -g -lrt -O0
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>
</span></span><span style=display:flex><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span><span style=color:#8be9fd;font-style:italic>CXXFLAGS</span> <span style=color:#ff79c6>=</span> -lrt -g -O0
</span></span></code></pre></div><h1 id=设计点1php-ini-配置选项>设计点1：PHP INI 配置选项<a class=anchorjs-link href=#%e8%ae%be%e8%ae%a1%e7%82%b91php-ini-%e9%85%8d%e7%bd%ae%e9%80%89%e9%a1%b9></a></h1><p>PulseFlow由于是一个基于C语言的PHP扩展，为了保持程序体的扩展性，配置选项一律从php.ini文件中读取，本节将描述所有与扩展程序有关系的配置信息。</p><h2 id=11-扩展功能开关参数-pulseflowenabled>1.1 扩展功能开关参数 （PulseFlow.enabled）<a class=anchorjs-link href=#11-%e6%89%a9%e5%b1%95%e5%8a%9f%e8%83%bd%e5%bc%80%e5%85%b3%e5%8f%82%e6%95%b0-pulseflowenabled></a></h2><h3 id=111-参数介绍>1.1.1 参数介绍<a class=anchorjs-link href=#111-%e5%8f%82%e6%95%b0%e4%bb%8b%e7%bb%8d></a></h3><p>这个参数是插件的功能开关，属于布尔类型，有效参数如下，默认 false：</p><ol><li>true：开启</li><li>false：关闭</li></ol><h2 id=12-日志功能开关参数-pulseflowdebug>1.2 日志功能开关参数 （PulseFlow.debug）<a class=anchorjs-link href=#12-%e6%97%a5%e5%bf%97%e5%8a%9f%e8%83%bd%e5%bc%80%e5%85%b3%e5%8f%82%e6%95%b0-pulseflowdebug></a></h2><h3 id=121-参数介绍>1.2.1 参数介绍<a class=anchorjs-link href=#121-%e5%8f%82%e6%95%b0%e4%bb%8b%e7%bb%8d></a></h3><p>这个参数是控制插件是否向页面输出调试信息，有效参数如下，默认 false：</p><ol><li>true：开启</li><li>false：关闭</li></ol><h2 id=13-禁止跟踪函数列表-pulseflowdisable_trace_functions>1.3 禁止跟踪函数列表 （PulseFlow.disable_trace_functions）<a class=anchorjs-link href=#13-%e7%a6%81%e6%ad%a2%e8%b7%9f%e8%b8%aa%e5%87%bd%e6%95%b0%e5%88%97%e8%a1%a8-pulseflowdisable_trace_functions></a></h2><h3 id=131-参数介绍>1.3.1 参数介绍<a class=anchorjs-link href=#131-%e5%8f%82%e6%95%b0%e4%bb%8b%e7%bb%8d></a></h3><p>这个参数是一个逗号分隔的字符串，代表一系列函数列表，这个函数列表内的函数不进行性能跟踪，默认空字符串。</p><p>配置样例：PulseFlow.disable_trace_functions = &ldquo;getLoader,findFile,loadClassLoader,getInitializer,findFileWithExtension,&rdquo;</p><h2 id=14-禁止跟踪类列表-pulseflowdisable_trace_class>1.4 禁止跟踪类列表 （PulseFlow.disable_trace_class）<a class=anchorjs-link href=#14-%e7%a6%81%e6%ad%a2%e8%b7%9f%e8%b8%aa%e7%b1%bb%e5%88%97%e8%a1%a8-pulseflowdisable_trace_class></a></h2><h3 id=141-参数介绍>1.4.1 参数介绍<a class=anchorjs-link href=#141-%e5%8f%82%e6%95%b0%e4%bb%8b%e7%bb%8d></a></h3><p>这个参数是一个逗号分隔的字符串，代表一系列类列表，这个类列表内的类不进行性能跟踪，默认空字符串。</p><p>配置样例：PulseFlow.disable_trace_functions = &ldquo;class1,class2,class3&rdquo;</p><h2 id=15-跟踪模式-pulseflowtrace_mode>1.5 跟踪模式 （PulseFlow.trace_mode）<a class=anchorjs-link href=#15-%e8%b7%9f%e8%b8%aa%e6%a8%a1%e5%bc%8f-pulseflowtrace_mode></a></h2><h3 id=151-参数介绍>1.5.1 参数介绍<a class=anchorjs-link href=#151-%e5%8f%82%e6%95%b0%e4%bb%8b%e7%bb%8d></a></h3><p>这个参数主要用来设置插件的性能跟踪工作模式，目前分类三类：simple、class、function 默认simple</p><ol><li>simple：简单模式、代表每个用户执行流程都将进行跟踪，排除在php.ini中配置的函数列表 及 类列表</li><li>class：类模式、根据类进行作为采样率</li><li>function：函数模式、根据函数作为采样率</li></ol><p>配置样例： PulseFLow.trace_mode = &ldquo;simple&rdquo;</p><h2 id=16-跟踪采样率-pulseflowtrace_rate>1.6 跟踪采样率 （PulseFlow.trace_rate）<a class=anchorjs-link href=#16-%e8%b7%9f%e8%b8%aa%e9%87%87%e6%a0%b7%e7%8e%87-pulseflowtrace_rate></a></h2><h3 id=161-参数介绍>1.6.1 参数介绍<a class=anchorjs-link href=#161-%e5%8f%82%e6%95%b0%e4%bb%8b%e7%bb%8d></a></h3><p>这个参数主要用来设置采样频率，默认值为0 ，代表每次都采集。 如果参数不为0 ,假设为n，则代表每n次进行一次采集。</p><h1 id=设计点2保存方式>设计点2：保存方式<a class=anchorjs-link href=#%e8%ae%be%e8%ae%a1%e7%82%b92%e4%bf%9d%e5%ad%98%e6%96%b9%e5%bc%8f></a></h1><p>数据保存方式，由于监控获取的数据集，如何更快更好的存储起来，也是保持链路高效的元素之一。</p><h2 id=21-保存介质目前实现内存堆区>2.1 保存介质（目前实现内存堆区）<a class=anchorjs-link href=#21-%e4%bf%9d%e5%ad%98%e4%bb%8b%e8%b4%a8%e7%9b%ae%e5%89%8d%e5%ae%9e%e7%8e%b0%e5%86%85%e5%ad%98%e5%a0%86%e5%8c%ba></a></h2><p>数据保存，首先应该考虑数据存储介质，好的存储介质为高速存储提供基础保障，目前主要考虑以下三种方案。</p><h3 id=211-内存堆区>2.1.1 内存堆区<a class=anchorjs-link href=#211-%e5%86%85%e5%ad%98%e5%a0%86%e5%8c%ba></a></h3><p>目前扩展基于堆区存储监控数据，没有发现内存泄露情况，后期会参考linux内核文件表结构，加入栈结构缓冲区来优化性能。</p><h3 id=212-内存栈区>2.1.2 内存栈区<a class=anchorjs-link href=#212-%e5%86%85%e5%ad%98%e6%a0%88%e5%8c%ba></a></h3><p>后期会借助内存栈区来实现数据缓冲区。</p><h3 id=213-寄存器区>2.1.3 寄存器区<a class=anchorjs-link href=#213-%e5%af%84%e5%ad%98%e5%99%a8%e5%8c%ba></a></h3><p>借助编译器，目前部分存储已经被优化至寄存器区。</p><h2 id=22-数据编码-pulseflowencode_type>2.2 数据编码（ PulseFlow.encode_type）<a class=anchorjs-link href=#22-%e6%95%b0%e6%8d%ae%e7%bc%96%e7%a0%81-pulseflowencode_type></a></h2><p>数据除了要注意存储介质以外，还需要注意数据编码格式、目前提供了Json序列化方式。</p><h3 id=221-配置参数>2.2.1 配置参数<a class=anchorjs-link href=#221-%e9%85%8d%e7%bd%ae%e5%8f%82%e6%95%b0></a></h3><p>用户可以在 php.ini 通过修改 PulseFlow.encode_type 的值来进行编码切换，默认值是json，目前提供的编码方式如下：</p><ol><li>json</li></ol><h1 id=设计点3发送模式-pulseflowsend_type>设计点3：发送模式（ PulseFlow.send_type）<a class=anchorjs-link href=#%e8%ae%be%e8%ae%a1%e7%82%b93%e5%8f%91%e9%80%81%e6%a8%a1%e5%bc%8f-pulseflowsend_type></a></h1><p>数据完整保存后，如何保障数据能够高速稳定的发送出去，是PulseFlow的最后关键一环。</p><h2 id=31发送通路介质选择>3.1发送通路介质选择<a class=anchorjs-link href=#31%e5%8f%91%e9%80%81%e9%80%9a%e8%b7%af%e4%bb%8b%e8%b4%a8%e9%80%89%e6%8b%a9></a></h2><p>首先从发送通路介质考虑，可以考虑如下四种方案，共享内存队列 、UDP、Unix domain Socket、TCP，目前为了保证最快的传输速度，我们选择了共享内存队列这种方案，在 Linux 环境下、目前提供了 System V 和 Posix 两大共享内存队列。</p><h3 id=311-共享内存队列>3.1.1 共享内存队列<a class=anchorjs-link href=#311-%e5%85%b1%e4%ba%ab%e5%86%85%e5%ad%98%e9%98%9f%e5%88%97></a></h3><p>目前实现了 System V 和 Posix 两大共享内存队列，两个队列的优缺点可以网络上自我查询，对于Posix 队列的服务端程序，我们采用了EPOLL 复用模型 来进行 I/O 监控。</p><h4 id=共享队列相关配置参数>共享队列相关配置参数<a class=anchorjs-link href=#%e5%85%b1%e4%ba%ab%e9%98%9f%e5%88%97%e7%9b%b8%e5%85%b3%e9%85%8d%e7%bd%ae%e5%8f%82%e6%95%b0></a></h4><ol><li><p><strong>PulseFlow.send_type</strong> ：数据发送类型，目前有posix 和 svipc ，<strong>默认为 pos</strong>ix</p></li><li><p>如果选择了 <strong>posix</strong>，则可以配置 <strong>PulseFlow.posix_name</strong> 参数，默认为 “<strong>/PulseFlow_posix_ipc</strong>”</p></li><li><p>如果选择了 <strong>svipc</strong>，则可以配置 （ <strong>PulseFlow.svipc_name</strong>参数 ：默认值为“<strong>/dev/shm/PulseFlow_sv_ipc</strong>”） 和 （ <strong>PulseFlow.svipc_pj_id</strong>参数 ： 默认为 <strong>1000</strong>）</p></li></ol><h4 id=运行环境特别注意><strong>运行环境特别注意</strong>：<a class=anchorjs-link href=#%e8%bf%90%e8%a1%8c%e7%8e%af%e5%a2%83%e7%89%b9%e5%88%ab%e6%b3%a8%e6%84%8f></a></h4><ol><li><p><strong>由于 svipc 的默认文件路径为 “/dev/shm/PulseFlow_sv_ipc” ，所以务必保证此文件实际存在，并且 php-fpm 有 写入权限。</strong></p></li><li><p><strong>由于 posix 的原理是给予内存映射文件，所以请务必保证 程序对于 /dev/mqueue/ 目录有读写权限。</strong></p></li></ol><h3 id=312-udp>3.1.2 UDP<a class=anchorjs-link href=#312-udp></a></h3><h3 id=313-unix-domain-socket>3.1.3 Unix domain socket<a class=anchorjs-link href=#313-unix-domain-socket></a></h3><h3 id=314-tcp>3.1.4 TCP<a class=anchorjs-link href=#314-tcp></a></h3><h1 id=设计点4扩展函数>设计点4：扩展函数<a class=anchorjs-link href=#%e8%ae%be%e8%ae%a1%e7%82%b94%e6%89%a9%e5%b1%95%e5%87%bd%e6%95%b0></a></h1><h2 id=41-pulseflow_enable-函数>4.1 pulseflow_enable 函数<a class=anchorjs-link href=#41-pulseflow_enable-%e5%87%bd%e6%95%b0></a></h2><p>启用 Pulse_FLow 监听功能，这个函数是在给扩展打开性能监控开关，这个函数之后的代码可以被监控起来。</p><h2 id=42-pulseflow_disable-函数>4.2 pulseflow_disable 函数<a class=anchorjs-link href=#42-pulseflow_disable-%e5%87%bd%e6%95%b0></a></h2><p>禁用 Pulse_FLow 监听功能，这个函数是在给扩展关闭性能监控开关，这个函数之后的代码失去监控状态。</p><hr style=visibility:hidden><ul class=pager><li class=previous><a href=/icorer_blog/posts/programming-notes-c-dynamic-link-library-programming/ data-toggle=tooltip data-placement=top title=编程笔记：C动态连接库编程>Previous<br><span>编程笔记：C动态连接库编程</span></a></li><li class=next><a href=/icorer_blog/posts/detect-and-analyze-memory-leaks-in-php-extensions/ data-toggle=tooltip data-placement=top title=检测并分析PHP扩展的内存泄露>Next<br><span>检测并分析PHP扩展的内存泄露</span></a></li></ul><hr style=visibility:hidden></div><div class="col-lg-8 col-lg-offset-2
col-md-10 col-md-offset-1
sidebar-container"><section><hr class="hidden-sm hidden-xs"><h5>FEATURED TAGS</h5><div class=tags><a href=/icorer_blog/tags/blockchain/>blockchain</a>
<a href=/icorer_blog/tags/clang/>CLang</a>
<a href=/icorer_blog/tags/cloudnative/>cloudnative</a>
<a href=/icorer_blog/tags/cmake/>Cmake</a>
<a href=/icorer_blog/tags/deca/>DeCA</a>
<a href=/icorer_blog/tags/dpki/>DPKI</a>
<a href=/icorer_blog/tags/drand/>drand</a>
<a href=/icorer_blog/tags/eip/>EIP</a>
<a href=/icorer_blog/tags/epoll/>epoll</a>
<a href=/icorer_blog/tags/ethereum/>Ethereum</a>
<a href=/icorer_blog/tags/fpga/>FPGA</a>
<a href=/icorer_blog/tags/gc/>GC</a>
<a href=/icorer_blog/tags/golang/>GoLang</a>
<a href=/icorer_blog/tags/hackathon/>Hackathon</a>
<a href=/icorer_blog/tags/http2/>HTTP2</a>
<a href=/icorer_blog/tags/http3/>HTTP3</a>
<a href=/icorer_blog/tags/icefiredb/>IceFireDB</a>
<a href=/icorer_blog/tags/k8s/>k8s</a>
<a href=/icorer_blog/tags/kafka/>kafka</a>
<a href=/icorer_blog/tags/layer2/>Layer2</a>
<a href=/icorer_blog/tags/linux/>linux</a>
<a href=/icorer_blog/tags/nginx/>Nginx</a>
<a href=/icorer_blog/tags/nosql/>NoSQL</a>
<a href=/icorer_blog/tags/php/>PHP</a>
<a href=/icorer_blog/tags/php-kernel/>php kernel</a>
<a href=/icorer_blog/tags/php%E5%86%85%E6%A0%B8/>PHP内核</a>
<a href=/icorer_blog/tags/quic/>QUIC</a>
<a href=/icorer_blog/tags/redis/>redis</a>
<a href=/icorer_blog/tags/sbt/>SBT</a>
<a href=/icorer_blog/tags/serverless/>serverless</a>
<a href=/icorer_blog/tags/ssi/>SSI</a>
<a href=/icorer_blog/tags/unikernel/>unikernel</a>
<a href=/icorer_blog/tags/wanxiang/>Wanxiang</a>
<a href=/icorer_blog/tags/web3/>web3</a>
<a href=/icorer_blog/tags/%E4%B8%AD%E9%97%B4%E4%BB%B6/>中间件</a>
<a href=/icorer_blog/tags/%E4%BA%91%E5%8E%9F%E7%94%9F/>云原生</a>
<a href=/icorer_blog/tags/%E4%BB%A5%E5%A4%AA%E5%9D%8A/>以太坊</a>
<a href=/icorer_blog/tags/%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8/>信息安全</a>
<a href=/icorer_blog/tags/%E5%86%85%E5%AD%98%E6%95%B0%E6%8D%AE%E5%BA%93/>内存数据库</a>
<a href=/icorer_blog/tags/%E5%86%85%E5%AD%98%E6%B3%84%E6%BC%8F/>内存泄漏</a>
<a href=/icorer_blog/tags/%E5%86%85%E6%A0%B8%E6%BA%90%E7%A0%81/>内核源码</a>
<a href=/icorer_blog/tags/%E5%86%85%E6%A0%B8%E7%A0%94%E7%A9%B6/>内核研究</a>
<a href=/icorer_blog/tags/%E5%8C%BA%E5%9D%97%E9%93%BE/>区块链</a>
<a href=/icorer_blog/tags/%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6/>垃圾回收</a>
<a href=/icorer_blog/tags/%E5%AD%98%E5%82%A8/>存储</a>
<a href=/icorer_blog/tags/%E5%AE%B9%E5%99%A8/>容器</a>
<a href=/icorer_blog/tags/%E5%BA%95%E5%B1%82%E5%BC%80%E5%8F%91/>底层开发</a>
<a href=/icorer_blog/tags/%E5%BA%95%E5%B1%82%E7%A0%94%E7%A9%B6/>底层研究</a>
<a href=/icorer_blog/tags/%E5%BC%80%E6%BA%90%E9%A1%B9%E7%9B%AE/>开源项目</a>
<a href=/icorer_blog/tags/%E5%BC%82%E6%9E%84%E8%AE%A1%E7%AE%97/>异构计算</a>
<a href=/icorer_blog/tags/%E5%BE%AE%E6%9C%8D%E5%8A%A1/>微服务</a>
<a href=/icorer_blog/tags/%E6%80%A7%E8%83%BD%E6%B5%8B%E8%AF%95/>性能测试</a>
<a href=/icorer_blog/tags/%E6%8A%80%E6%9C%AF%E7%A7%91%E6%99%AE/>技术科普</a>
<a href=/icorer_blog/tags/%E6%95%B0%E6%8D%AE%E5%BA%93%E6%8A%80%E6%9C%AF/>数据库技术</a>
<a href=/icorer_blog/tags/%E6%96%87%E7%AB%A0%E7%BF%BB%E8%AF%91/>文章翻译</a>
<a href=/icorer_blog/tags/%E6%96%B0%E6%9E%B6%E6%9E%84/>新架构</a>
<a href=/icorer_blog/tags/%E6%97%B6%E5%BA%8F%E6%95%B0%E6%8D%AE%E5%BA%93/>时序数据库</a>
<a href=/icorer_blog/tags/%E6%9C%8D%E5%8A%A1%E6%B2%BB%E7%90%86/>服务治理</a>
<a href=/icorer_blog/tags/%E6%9C%8D%E5%8A%A1%E7%BD%91%E6%A0%BC/>服务网格</a>
<a href=/icorer_blog/tags/%E6%9C%8D%E5%8A%A1%E9%81%A5%E6%B5%8B/>服务遥测</a>
<a href=/icorer_blog/tags/%E6%B5%8B%E8%AF%95%E6%8A%A5%E5%91%8A/>测试报告</a>
<a href=/icorer_blog/tags/%E7%A0%94%E7%A9%B6%E6%8A%A5%E5%91%8A/>研究报告</a>
<a href=/icorer_blog/tags/%E7%BC%93%E5%AD%98%E6%8A%80%E6%9C%AF/>缓存技术</a>
<a href=/icorer_blog/tags/%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8/>网络安全</a>
<a href=/icorer_blog/tags/%E8%99%9A%E6%8B%9F%E6%9C%BA/>虚拟机</a>
<a href=/icorer_blog/tags/%E8%A1%8C%E4%B8%9A%E6%8A%A5%E5%91%8A/>行业报告</a>
<a href=/icorer_blog/tags/%E8%AE%BA%E6%96%87/>论文</a>
<a href=/icorer_blog/tags/%E9%9B%B6%E4%BF%A1%E4%BB%BB/>零信任</a>
<a href=/icorer_blog/tags/%E9%AB%98%E6%80%A7%E8%83%BD/>高性能</a></div></section></div></div></div></article><footer><div class=container><div class=row><div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1"><ul class="list-inline text-center"><li><a href=/icorer_blog/index.xml><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i>
<i class="fa fa-rss fa-stack-1x fa-inverse"></i></span></a></li><li><a href=https://twitter.com/corerman1><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i>
<i class="fa fa-twitter fa-stack-1x fa-inverse"></i></span></a></li><li><a target=_blank href=https://github.com/gitsrc><span class="fa-stack fa-lg"><i class="fa fa-circle fa-stack-2x"></i>
<i class="fa fa-github fa-stack-1x fa-inverse"></i></span></a></li></ul><p class="copyright text-muted">Copyright &copy; 笔迹-工匠之芯 2023</p></div></div></div></footer><script src=/icorer_blog/js/jquery.min.js></script>
<script src=/icorer_blog/js/bootstrap.min.js crossorigin=anonymous></script>
<script src=/icorer_blog/js/hux-blog.min.c4ea77041cd3edbfc8b2622cd887a9a5d8760a4162d14489e36d2a3fa4c90172.js></script>
<script src=/icorer_blog/js/simple-jekyll-search.min.js></script>
<script src=/icorer_blog/js/search.min.7d1445cf07369bca2715d9f63738c16c73a7a2273a95d6729bee561f7e84c6c8.js></script>
<script src=/icorer_blog/zoomjs/zoom.min.js></script>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-VB37D8LWFT"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-VB37D8LWFT")</script></body></html>