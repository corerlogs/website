<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>kafka on 笔迹-工匠之芯</title><link>https://icorer.com/icorer_blog/tags/kafka/</link><description>Recent content in kafka on 笔迹-工匠之芯</description><generator>Hugo -- gohugo.io</generator><language>zh-cn</language><lastBuildDate>Fri, 06 Mar 2020 12:41:18 +0800</lastBuildDate><atom:link href="https://icorer.com/icorer_blog/tags/kafka/index.xml" rel="self" type="application/rss+xml"/><item><title>PHP-rdkafka 内核扩展相关源码分析</title><link>https://icorer.com/icorer_blog/posts/php-rdkafka-kernel-extension-related-source-code-analysis/</link><pubDate>Fri, 06 Mar 2020 12:41:18 +0800</pubDate><guid>https://icorer.com/icorer_blog/posts/php-rdkafka-kernel-extension-related-source-code-analysis/</guid><description>这篇文章主要针对PHP生态的的kafka组件 php-rdkafka 进行相关的内核源码分析，方便大家把握组件的相关使用，目前文章主要针对kafka生产者部分。
一. 样例PHP代码 1public function __construct($config) 2 { 3 $conf = new \RdKafka\Conf(); 4 $conf-&amp;gt;set(&amp;#39;metadata.broker.list&amp;#39;, $config[&amp;#39;brokerList&amp;#39;]); 5 $conf-&amp;gt;set(&amp;#39;message.max.bytes&amp;#39;, $config[&amp;#39;messageMaxBytes&amp;#39;]); 6 $conf-&amp;gt;set(&amp;#39;metadata.request.timeout.ms&amp;#39;, $config[&amp;#39;requestTimeout&amp;#39;]); 7 $conf-&amp;gt;set(&amp;#39;session.timeout.ms&amp;#39;, $config[&amp;#39;sessionTimeout&amp;#39;]); 8 $this-&amp;gt;producer = new \RdKafka\Producer($conf); 9 $this-&amp;gt;producer-&amp;gt;addBrokers($config[&amp;#39;brokerList&amp;#39;]); 10 } 11 12 public function sendMessage($data){ 13 $result = 1; 14 $topic = $this-&amp;gt;producer-&amp;gt;newTopic($data[0][&amp;#39;topic&amp;#39;]); 15 $topic-&amp;gt;produce(RD_KAFKA_PARTITION_UA, 0, $data[0][&amp;#39;value&amp;#39;]); 16 $this-&amp;gt;producer-&amp;gt;poll(0); 17 for ($flushRetries = 0; $flushRetries &amp;lt; 10; $flushRetries++) { 18 $result = $this-&amp;gt;producer-&amp;gt;flush(10000); 19 if (RD_KAFKA_RESP_ERR_NO_ERROR === $result) { 20 break; 21 } 22 } 23 if (RD_KAFKA_RESP_ERR_NO_ERROR !</description></item></channel></rss>